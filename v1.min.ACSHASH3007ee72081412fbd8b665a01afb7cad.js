'use strict';window.ExpConsentUtils=window.ExpConsentUtils||{};window.ExpConsentUtils=function(){return{waitForObj:function(f){return new Promise(function(d,c){var e=0,g=setInterval(function(){10>e?"visitor"==f&&"object"===typeof visitor&&visitor||"wcpconsent"==f&&"undefined"!==typeof WcpConsent&&WcpConsent&&"undefined"!==typeof WcpConsent.siteConsent&&WcpConsent.siteConsent?(clearInterval(g),d()):e++:(clearInterval(g),c())},500)})}}}();
var ExpConsentHandler=function(){function f(){window.ExpConsentUtils.waitForObj("visitor").then(function(){visitor.getVisitorValues(function(a){adobe.target.trackEvent({mbox:"personalizationConsent"})})}).catch(function(a){console.log(a)})}function d(){return WcpConsent&&WcpConsent.siteConsent&&void 0!==WcpConsent.siteConsent.isConsentRequired&&null!==WcpConsent.siteConsent.isConsentRequired?WcpConsent.siteConsent.isConsentRequired:!0}function c(){var a=WcpConsent&&WcpConsent.siteConsent?WcpConsent.siteConsent.getConsent():
void 0;return a&&a.Advertising&&a.Analytics&&a.SocialMedia}function e(a,b){var d=g(a),c=new Date;c.setTime(c.getTime()+b);b="expires\x3d"+c.toUTCString();document.cookie=a+"\x3d"+d+"; "+b+"; path\x3d/;domain\x3d.microsoft.com;"}function g(a){var b=a+"\x3d",c;decodeURIComponent(document.cookie).split("; ").forEach(function(a){0===a.indexOf(b)&&(c=a.substring(b.length))});return c}function h(a){for(var b=0;b<a.length;b++)document.cookie=a[b]+"\x3d;max-age\x3d-1;path\x3d/;domain\x3d.microsoft.com;"}
function k(){if(c())l(),e("mbox",34186698E3),f();else{h(["AMCV_EA76ADE95776D2EC7F000101%40AdobeOrg","AMCVS_EA76ADE95776D2EC7F000101%40AdobeOrg"]);var a=document.getElementById("visitor-script");a&&a.remove();e("mbox",2592E6)}}function m(){c()||h(["mbox","AMCV_EA76ADE95776D2EC7F000101%40AdobeOrg","AMCVS_EA76ADE95776D2EC7F000101%40AdobeOrg"])}function n(){window.ExpConsentUtils.waitForObj("wcpconsent").then(function(){var a=window.cas.exp.target.isExpWithoutPersonalizationEnabled;if(d())if(a)WcpConsent.onConsentChanged(k);
else WcpConsent.onConsentChanged(m);(!d()||d()&&c())&&l();if(a||!d()||d()&&c()){var b="/etc.clientlibs/microsoft/components/structure/page/clientlibs/experimentation.ACSHASH"+window.cas.exp.target.expJsHash+".min.js",e=document.createElement("script");e.type="text/javascript";e.src=b;b=document.getElementsByName("exp-atjs-anchor")[0];b.parentElement.insertBefore(e,b)}a&&d()&&c()&&f()}).catch(function(a){console.log(a)})}function l(){var a="/etc.clientlibs/microsoft/components/structure/page/clientlibs/visitor.ACSHASH"+
window.cas.exp.target.visitorJsHash+".min.js",b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="visitor-script";a=document.getElementsByName("exp-visitor-anchor")[0];a.parentElement.insertBefore(b,a)}"object"===typeof exports&&(module.exports={consentChangeCallBack:k,handleExpScripts:n,isConsentRequired:d,checkUserConsent:c,syncTargetProfileWithMCID:f,consentChangeCallBackWithoutPersonalization:m});return{handleExpScripts:n,isConsentRequired:d,checkUserConsent:c}}();
"complete"===document.readyState||"interactive"===document.readyState?ExpConsentHandler.handleExpScripts():document.addEventListener("DOMContentLoaded",ExpConsentHandler.handleExpScripts,!1);